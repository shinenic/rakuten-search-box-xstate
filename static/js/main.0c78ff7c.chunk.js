(this["webpackJsonprakuten-mall-sp-searchbox"]=this["webpackJsonprakuten-mall-sp-searchbox"]||[]).push([[0],{30:function(e,t,n){},31:function(e,t,n){"use strict";n.r(t);var r=n(2),c=n(7),a=n.n(c),s=n(21),o=n.n(s),i=n(17),u=n(34),l=n(14),h=n(16),d=n(35),g=n(5),b=function(e){for(var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=n.length,c=0;c<e;c++)t+=n.charAt(Math.floor(Math.random()*r));return t},p=n(12),j={initial:"idle",on:{GET_SUGGESTIONS:{target:".fetching"},TOGGLE_DEBOUCING_INPUT:{target:".deboucingInput",internal:!1,actions:"setInputValue"},TOGGLE_CLEAN:{actions:["cleanSuggestion","cleanInputValue"]},CHANGE_SEARCH_MODE:{actions:"setSearchMode"},CANCEL_SEARCH:{target:"close"},DO_SEARCH:{cond:"withInputValue",target:"close",actions:["setKeyword","setFilter"]}},states:{idle:{},deboucingInput:{after:Object(h.a)({},1e3,"fetching")},fetching:{entry:"cleanSuggestionError",invoke:{id:"fetch-suggestion",src:"fetchSuggestion",onDone:[{cond:"withInputValue",target:"idle",actions:"setSuggestions"},{target:"idle"}],onError:{target:"error",actions:["setSuggestionError"]}}},error:{}}},_={initial:"close",id:"search-box-modal",states:{open:Object(l.a)({exit:"cleanSuggestion"},j),close:{on:{OPEN_SEARCH_BOX:[{cond:"withKeyword",target:"open.fetching",actions:["resetInputValue","resetSearchMode"]},{target:"open.idle",actions:["resetInputValue","resetSearchMode"]}]}}}},O={MALL:"\u5168\u7ad9",JAPAN:"\u65e5\u672c\u8cfc\u7269/\u65c5\u904a",BOOK:"\u66f8\u7c4d/\u96fb\u5b50\u66f8"},v={keyword:"",filter:{mode:""},inputValue:"",result:"",searchMode:O.MALL,suggestions:[],loading:!1,suggestionError:null},f=Object(d.a)(Object(l.a)({id:"RakutenMallMobileSearchbox",context:v},_),{actions:{cleanSuggestion:Object(g.b)({suggestions:[]}),cleanInputValue:Object(g.b)({inputValue:""}),cleanSuggestionError:Object(g.b)({suggestionError:null}),setKeyword:Object(g.b)({keyword:function(e,t){return t.keyword||""}}),setFilter:Object(g.b)({filter:function(e,t){var n=e.filter,r=t.newFilter,c=void 0===r?{}:r;return Object(l.a)(Object(l.a)({},n),c)}}),setInputValue:Object(g.b)({inputValue:function(e,t){return t.keyword}}),setSuggestions:Object(g.b)({suggestions:function(e,t){var n;return null!==(n=null===t||void 0===t?void 0:t.data)&&void 0!==n?n:[]}}),setSearchMode:Object(g.b)({searchMode:function(e,t){return t.searchMode}}),setResult:Object(g.b)({result:function(e,t){return t.result}}),setSuggestionError:Object(g.b)({suggestionError:function(e,t){return null===t||void 0===t?void 0:t.data}}),resetInputValue:Object(g.b)({inputValue:function(e){return e.keyword}}),resetSearchMode:Object(g.b)({searchMode:O.MALL})},guards:{withInputValue:function(e){var t=e.inputValue;return Boolean(t)},withKeyword:function(e){var t=e.keyword;return Boolean(t)}},services:{fetchSuggestion:function(e,t){var n=e.inputValue;t.keyword;return new Promise((function(e){setTimeout((function(){for(var t=[],r=0;r<7;r++)t.push("".concat(n).concat(b(Object(p.random)(3,10))));e(t)}),1e3)}))}}}),x=Object(c.createContext)(),S=function(){return Object(c.useContext)(x)},w=function(e){var t=e.children,n=Object(u.a)(f,{devTools:!0}),c=Object(i.a)(n,2),a=c[0],s=c[1];var o=a.context.searchMode,l={openSearchBox:function(){return s("OPEN_SEARCH_BOX")},closeSearchBox:function(){return s("CANCEL_SEARCH")},changeSearchMode:function(e){return s({type:"CHANGE_SEARCH_MODE",searchMode:e})},toggleDeboucingInput:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return s({type:"TOGGLE_DEBOUCING_INPUT",keyword:e})},cleanInput:function(){return s("TOGGLE_CLEAN")},doSearch:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{mode:o};return s({type:"DO_SEARCH",keyword:e,newFilter:t})}};return Object(r.jsx)(x.Provider,{value:{state:a,send:s,context:a.context,actions:l},children:t})},m=function(){var e=S(),t=e.state,n=e.context.searchMode,c=e.actions.changeSearchMode;return t.matches("open")?Object(r.jsx)("div",{className:"search-page__search-tabs",children:Object(p.toPairs)(O).map((function(e){var t=Object(i.a)(e,2),a=t[0],s=t[1],o=n===s,u=o?"search-page__search-tabs__tab search-page__search-tabs__tab--active":"search-page__search-tabs__tab";return Object(r.jsx)("div",{className:u,onClick:function(){return!o&&c(O[a])},children:s},a)}))}):null},E=function(){var e=S().state,t=e.matches("open.fetching");return e.matches("open.deboucingInput")?Object(r.jsxs)("div",{className:"search-page__suggestion-wrapper__progress",children:[Object(r.jsx)("b",{children:"Debouncing"})," \u21e2 Fetching \u21e2 Finish"]}):t?Object(r.jsxs)("div",{className:"search-page__suggestion-wrapper__progress",children:["Debouncing \u21e2 ",Object(r.jsx)("b",{children:"Fetching"})," \u21e2 Finish"]}):Object(r.jsxs)("div",{className:"search-page__suggestion-wrapper__progress",children:["Debouncing \u21e2 Fetching \u21e2 ",Object(r.jsx)("b",{children:"Finish"})]})},C=function(){var e=S(),t=e.state,n=e.context,c=n.suggestions,a=void 0===c?[]:c,s=n.inputValue,o=e.actions.doSearch;if(!t.matches("open"))return null;var i=function(e){return function(){return o(e)}};return Object(r.jsxs)("div",{className:"search-page__suggestion-wrapper",children:[Object(r.jsx)("div",{className:"search-page__suggestion-wrapper__row",onClick:i(s),children:Object(r.jsx)("b",{children:s})}),a.map((function(e,t){var n=e.substr(s.length);return Object(r.jsxs)("div",{className:"search-page__suggestion-wrapper__row",onClick:i(e),children:[Object(r.jsx)("b",{children:s}),n]},t)})),Object(r.jsx)(E,{})]})},N=function(){var e=S(),t=e.state,n=e.context,c=n.keyword,a=n.inputValue,s=e.actions,o=s.openSearchBox,i=s.closeSearchBox,u=s.toggleDeboucingInput,l=s.cleanInput,h=s.doSearch,d=t.matches("open"),g=d?"search-page__search-box search-page__search-box--open":"search-page__search-box",b=d?a:c,j=d&&!Object(p.isEmpty)(a);return Object(r.jsxs)("div",{className:g,children:[Object(r.jsxs)("div",{className:"search-page__input-row",children:[Object(r.jsx)("input",{onClick:function(){d||o()},onChange:function(e){u(e.target.value)},value:b,className:"search-page__input-row__input",placeholder:"keywords..."}),j&&Object(r.jsx)("div",{onClick:l,className:"search-page__input-row__clean",children:"X"}),Object(r.jsx)("div",{onClick:function(){d?h(a):o()},className:"search-page__input-row__button search-page__input-row__button--search",children:"Search"}),d&&Object(r.jsx)("div",{className:"search-page__input-row__button",onClick:i,children:"Cancel"})]}),Object(r.jsx)(m,{}),Object(r.jsx)(C,{})]})},k=function(){var e,t=S().context,n=t.keyword,c=t.filter,a=null!==(e=null===c||void 0===c?void 0:c.mode)&&void 0!==e?e:"";return Object(r.jsxs)("div",{className:"search-page",children:[Object(r.jsx)("div",{className:"search-page__title",children:"Search Page"}),Object(r.jsx)(N,{}),Object(r.jsxs)("div",{className:"search-page__content",children:[Object(r.jsxs)("div",{children:["\u641c\u5c0b\u6a21\u5f0f\uff1a",a]}),Object(r.jsxs)("div",{children:["\u641c\u5c0b\u7d50\u679c\uff1a",n]})]})]})},I=(n(30),function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,36)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,a=t.getLCP,s=t.getTTFB;n(e),r(e),c(e),a(e),s(e)}))});o.a.render(Object(r.jsx)(a.a.StrictMode,{children:Object(r.jsx)(w,{children:Object(r.jsx)(k,{})})}),document.getElementById("root")),I()}},[[31,1,2]]]);
//# sourceMappingURL=main.0c78ff7c.chunk.js.map